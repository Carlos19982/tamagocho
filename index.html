<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tamagochi - Ciclo DinÃ¡mico y Minijuegos</title>

  <!-- Meta tags para evitar la cachÃ© -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <!-- Agregar un query string a los recursos para forzar que se recarguen -->
  <link rel="stylesheet" type="text/css" href="style.css?v=1.1" />
  <script defer src="background.js?v=1.1"></script>
  <script defer src="tm.js?v=1.1"></script>
</head>

<body>
  <!-- Â¡NUEVO! Lienzo dedicado para el fondo dinÃ¡mico -->
  <canvas id="background-canvas"></canvas>

  <!-- Overlay compartido para menÃºs modales -->
  <div id="menu-overlay"></div>

  <!-- BotÃ³n de Ajustes (Rueda) -->
  <button id="settings-icon" onclick="toggleMenu('settings-menu')"><span>âš™ï¸</span></button>

  <div id="popup-message"
    style="position: fixed; top: 10px; right: 10px; background: rgba(0,0,0,0.8); color: #fff; padding: 10px 15px; border-radius: 5px; display: none; z-index: 10000; font-family: sans-serif; font-size: 0.9rem;">
  </div>

  <!-- MenÃº de configuraciÃ³n -->
  <div class="menu-container">
    <h1>Configura tu Tamagotchi</h1>
    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" placeholder="Ingresa un nombre" />
    <label for="trabajo">Futuro Trabajo:</label>
    <select id="trabajo"
      style="width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px; border: 1px solid #ddd;">
      <option value="flappy">Flappygocho</option>
    </select>
    <label for="edad">Edad de inicio:</label>
    <input type="number" id="edad" placeholder="Ej: 5" />
    <button id="start-game">Â¡Comenzar Juego!</button>
  </div>

  <!-- Ãrea del juego -->
  <div class="tamagochi-container">
    <!-- MenÃºs existentes -->
    <!-- MENÃš DE ALIMENTACIÃ“N -->
    <div id="food-menu" class="action-modal">
      <div class="modal-header">
        <h2>ğŸ” AlimentaciÃ³n</h2>
        <button class="close-modal-btn" onclick="toggleMenu('food-menu')">Ã—</button>
      </div>
      <div class="modal-body">
        <!-- Contenido dinÃ¡mico -->
      </div>
    </div>

    <!-- MENÃš DE LIMPIEZA -->
    <div id="clean-menu" class="action-modal">
      <div class="modal-header">
        <h2>ğŸš¿ Higiene</h2>
        <button class="close-modal-btn" onclick="toggleMenu('clean-menu')">Ã—</button>
      </div>
      <div class="modal-body">
        <button id="juego-ducha">
          <span class="icon">ğŸ§¼</span>
          <span>Ducha Minijuego</span>
        </button>
      </div>
    </div>

    <!-- MENÃš DE JUEGO -->
    <div id="game-menu" class="action-modal">
      <div class="modal-header">
        <h2>ğŸ® DiversiÃ³n</h2>
        <button class="close-modal-btn" onclick="toggleMenu('game-menu')">Ã—</button>
      </div>
      <div class="modal-body">
        <button id="juego-saltar">
          <span class="icon">ğŸƒ</span>
          <span>Saltar ObstÃ¡culos</span>
        </button>
        <button id="juego-reaccion">
          <span class="icon">âš¡</span>
          <span>Prueba de ReacciÃ³n</span>
        </button>
      </div>
    </div>

    <!-- MENÃš DE SUEÃ‘O -->
    <div id="sleep-menu" class="action-modal">
      <div class="modal-header">
        <h2>ğŸ’¤ Descanso</h2>
        <button class="close-modal-btn" onclick="toggleMenu('sleep-menu')">Ã—</button>
      </div>
      <div class="modal-body">
        <button id="btn-dormir-largo">
          <span class="icon">ğŸŒ™</span>
          <span>Dormir (Largo)</span>
        </button>
        <button id="btn-siesta">
          <span class="icon">ğŸ›Œ</span>
          <span>Siesta (Corta)</span>
        </button>
      </div>
    </div>

    <!-- MENU DE TRABAJO (No modificado a modal nuevo por complejidad, pero se mantiene) -->
    <!-- MENÃš DE TRABAJO (RediseÃ±ado) -->
    <div id="work-menu" class="action-modal">
      <div class="modal-header">
        <h2>ğŸ’¼ Trabajo & Ciudad</h2>
        <button class="close-modal-btn" onclick="toggleMenu('work-menu')">Ã—</button>
      </div>
      <div class="modal-body">
        <button id="btn-medico">
          <span class="icon">ğŸ©º</span>
          <span>Ir al mÃ©dico (170$)</span>
        </button>
        <button id="btn-paseo">
          <span class="icon">ğŸï¸</span>
          <span>Salir de Paseo</span>
        </button>

        <!-- SecciÃ³n de trabajo especial -->
        <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; margin-top: 5px;">
          <p style="margin: 0 0 10px 0; font-size: 0.9rem; color: #ccc;">Trabajo actual: <strong
              id="current-job-display">...</strong>
          </p>
          <button id="btn-work-action">
            <span class="icon">ğŸ’¼</span>
            <span>Ir a trabajar</span>
          </button>
        </div>

        <button id="btn-requisitos">
          <span class="icon">ğŸ“ˆ</span>
          <span>Requisitos Ascenso</span>
        </button>
        <!-- Contenedor para mostrar requisitos dinÃ¡micamente -->
        <div id="requisitos-display" style="margin-top: 5px; font-size: 0.85rem; color: #eee; line-height: 1.4;"></div>
      </div>
    </div>

    <div id="minijuego-container">
      <div id="minijuego-gamearea">
        <div id="game-character">(*_*)</div>
      </div>
      <div id="minijuego-instructions">
        Â¡Presiona el botÃ³n cuando sea tu turno!
      </div>
      <button id="boton-saltar">Saltar</button>
    </div>

    <!-- Contenedor superior: MuÃ±eco y notificaciones -->
    <div class="top-container">
      <div id="muÃ±eco-container">
        <!-- Personaje en modo Moderno (CSS) -->
        <div id="modern-character" style="display: none;">
          <div class="character-body">
            <div class="face">
              <div class="eyes">
                <div class="eye left"></div>
                <div class="eye right"></div>
              </div>
              <div class="cheeks">
                <div class="cheek"></div>
                <div class="cheek"></div>
              </div>
              <div class="mouth"></div>
              <div class="zzz-container">
                <span>Z</span>
                <span>Z</span>
                <span>Z</span>
              </div>
              <div class="poop-container">
                <span class="poop">ğŸ’©</span>
                <span class="poop">ğŸ’©</span>
                <span class="poop">ğŸ’©</span>
              </div>
            </div>
          </div>
        </div>

        <pre id="tamagochi-feliz">
(\_/)
( ^_^)
(>   <)
          </pre>
        <pre id="tamagochi-feliz-caca">
(\_/)
( âš†_âš† )
(>ğŸ’©<)
          </pre>
        <pre id="tamagochi">
(\_/)
( Â°_Â° )
(>   <)
          </pre>
        <pre id="tamagochi-domir">
(\_/)
    ( -_-) Zzz
(>  <)
          </pre>
        <pre id="tamagochi_caca">
(\_/)
( âš†_âš† )
(>ğŸ’©<)
          </pre>
        <pre id="tamagochi_caca-domir">
(\_/)
     ( -_-) Zzz
(>ğŸ’©<)
          </pre>
        <pre id="tamagochi_sueÃ±o">
   (\_/) zZz
( Â°_Â°)
(>  <)
          </pre>
        <pre id="tamagochi_sueÃ±o_caca">
   (\_/) zZz
( Â°_Â°)
(>ğŸ’©<)
          </pre>
        <pre id="tamagochi_aburrido">
(\_/)
( Â°~Â° )
<(   )>
          </pre>
        <pre id="tamagochi_aburrido_caca">
(\_/)
( Â°~Â° )
<(ğŸ’©)>
          </pre>
        <pre id="tamagochi_hambriento">
     (\_/) ~ ğŸ•
( Â°ï¹ƒÂ° )
<(   )>
          </pre>
        <pre id="tamagochi_hambriento_caca">
(\_/)
( Â°ï¹ƒÂ° )
<(ğŸ’©)>
          </pre>
        <pre id="tamagochi_muerto">
  âš°ï¸
(\_/)
( x_x )
<(   )>
          </pre>
      </div>
      <div id="notification-container"></div>
    </div>

    <!-- InformaciÃ³n y controles -->
    <div id="info-container"></div>
    <div class="buttons-container">
      <!-- Control Card: Hambre -->
      <div class="control-card">
        <div class="stat-label">
          <span class="stat-icon">ğŸ–</span> Hambre
        </div>
        <div class="progress">
          <div class="progress-bar" id="progress-hambre"></div>
        </div>
        <button id="btn-hambre" class="action-btn">Alimentar</button>
      </div>

      <!-- Control Card: Aburrimiento -->
      <div class="control-card">
        <div class="stat-label">
          <span class="stat-icon">ğŸ®</span> Aburrimiento
        </div>
        <div class="progress">
          <div class="progress-bar" id="progress-aburrimiento"></div>
        </div>
        <button id="btn-aburrimiento" class="action-btn">Jugar</button>
      </div>

      <!-- Control Card: SueÃ±o -->
      <div class="control-card">
        <div class="stat-label">
          <span class="stat-icon">ğŸ’¤</span> SueÃ±o
        </div>
        <div class="progress">
          <div class="progress-bar" id="progress-sueno"></div>
        </div>
        <button id="btn-sueno" class="action-btn">Dormir</button>
      </div>

      <!-- Control Card: Higiene -->
      <div class="control-card">
        <div class="stat-label">
          <span class="stat-icon">ğŸš¿</span> Higiene
        </div>
        <div class="progress">
          <div class="progress-bar" id="progress-higiene"></div>
        </div>
        <button id="btn-higiene" class="action-btn">Limpiar</button>
      </div>
    </div>
  </div>

  <!-- Juego Flappy Bird a pantalla completa -->
  <div id="flappy-game">
    <div id="flappy-game-area">
      <div id="flappy-bird">(*_*)</div>
    </div>
    <div id="flappy-start-overlay">Click to start</div>
  </div>

  <!-- Icono para abrir la tienda -->
  <div id="store-icon">ğŸ›’</div>

  <!-- Overlay de la tienda -->
  <div id="store-overlay" style="display: none;">
    <div id="store-book">
      <!-- BotÃ³n de cierre -->
      <button id="close-store-btn" class="close-book-button">Ã—</button>

      <!-- PÃ¡gina 1: Comida Sana -->
      <div class="store-page" data-page-id="healthy-food">
        <h2>Comida Sana</h2>
        <div class="store-item-grid">
          <div class="store-item"><span class="item-name">Smoothie</span><span class="item-price">150
              monedas</span><button class="buy-btn">Comprar</button></div>
          <div class="store-item"><span class="item-name">Ensalada</span><span class="item-price">120
              monedas</span><button class="buy-btn">Comprar</button></div>
          <div class="store-item"><span class="item-name">Yogurt</span><span class="item-price">110
              monedas</span><button class="buy-btn">Comprar</button></div>
          <div class="store-item"><span class="item-name">Manzana</span><span class="item-price">100
              monedas</span><button class="buy-btn">Comprar</button></div>
          <div class="store-item"><span class="item-name">Zanahoria</span><span class="item-price">80
              monedas</span><button class="buy-btn">Comprar</button></div>
        </div>
      </div>

      <!-- PÃ¡gina 2: Comida RÃ¡pida -->
      <div class="store-page" data-page-id="fast-food">
        <h2>Comida RÃ¡pida</h2>
        <div class="store-item-grid">
          <div class="store-item"><span class="item-name">Pizza</span><span class="item-price">500 monedas</span><button
              class="buy-btn">Comprar</button></div>
          <div class="store-item"><span class="item-name">Hamburguesa</span><span class="item-price">250
              monedas</span><button class="buy-btn">Comprar</button></div>
          <div class="store-item"><span class="item-name">Papas Fritas</span><span class="item-price">160
              monedas</span><button class="buy-btn">Comprar</button></div>
          <div class="store-item"><span class="item-name">Helado</span><span class="item-price">160
              monedas</span><button class="buy-btn">Comprar</button></div>
          <div class="store-item"><span class="item-name">Refresco</span><span class="item-price">140
              monedas</span><button class="buy-btn">Comprar</button></div>
        </div>
      </div>

      <!-- PÃ¡gina 3: Medicinas -->
      <div class="store-page" data-page-id="medicines">
        <h2>Medicinas</h2>
        <div class="store-item-grid">
          <div class="store-item"><span class="item-name">Pastilla</span><span class="item-price">250
              monedas</span><button class="buy-btn">Comprar</button></div>
          <div class="store-item"><span class="item-name">Jeringuilla</span><span class="item-price">600
              monedas</span><button class="buy-btn">Comprar</button></div>
          <div class="store-item" id="store-item-insulina"><span class="item-name">Insulina</span><span
              class="item-price">350 monedas</span><button class="buy-btn">Comprar</button></div>
        </div>
      </div>

      <!-- PÃ¡gina 4: Objetos -->
      <div class="store-page" data-page-id="objects">
        <h2>Objetos</h2>
        <div class="store-item-grid" id="store-objects-grid">
          <div class="store-item" data-item-type="movil"><span class="item-name"></span><span
              class="item-price"></span><button class="buy-btn">Comprar</button></div>
          <div class="store-item" data-item-type="habitacion"><span class="item-name"></span><span
              class="item-price"></span><button class="buy-btn">Comprar</button></div>
          <div class="store-item" data-item-type="bicicleta"><span class="item-name"></span><span
              class="item-price"></span><button class="buy-btn">Comprar</button></div>
          <div class="store-item" data-item-type="portatil"><span class="item-name"></span><span
              class="item-price"></span><button class="buy-btn">Comprar</button></div>
          <div class="store-item" data-item-type="auriculares"><span class="item-name"></span><span
              class="item-price"></span><button class="buy-btn">Comprar</button></div>
        </div>
      </div>

      <!-- Controles del libro de la tienda -->
      <div id="store-controls">
        <button id="store-prev-page">â€¹ Anterior</button>
        <button id="store-next-page">Siguiente â€º</button>
      </div>
    </div>
  </div>

  <div id="inventory-icon">ğŸ›ï¸</div>
  <!-- Overlay de Inventario en Full Screen -->
  <div id="inventory-overlay" style="display: none;">
    <div id="inventory-book">
      <!-- BotÃ³n de cierre -->
      <button id="close-inventory-btn" class="close-book-button">Ã—</button>
      <!-- PÃ¡ginas del libro -->
      <div class="inventory-page" data-page-id="store">
        <h2>Propiedades</h2>
        <div class="item-grid" id="inventory-store-list"></div>
      </div>
      <div class="inventory-page" data-page-id="common">
        <h2>Tesoros Comunes</h2>
        <div class="item-grid" id="inventory-common-list"></div>
      </div>
      <div class="inventory-page" data-page-id="uncommon">
        <h2>Tesoros Poco Comunes</h2>
        <div class="item-grid" id="inventory-uncommon-list"></div>
      </div>
      <div class="inventory-page" data-page-id="rare">
        <h2>Tesoros Raros</h2>
        <div class="item-grid" id="inventory-rare-list"></div>
      </div>

      <!-- Controles del libro -->
      <div id="inventory-controls">
        <button id="prev-page">â€¹ Anterior</button>
        <button id="open-museum-btn">Museo de Duplicados</button>
        <button id="next-page">Siguiente â€º</button>
      </div>
    </div>
  </div>




  <!-- Â¡NUEVO! Overlay del Museo de Duplicados -->
  <div id="museum-overlay" style="display: none;">
    <div id="museum-book">
      <!-- BotÃ³n de cierre -->
      <button id="close-museum-btn" class="close-book-button">Ã—</button>

      <!-- PÃ¡ginas del libro del museo -->
      <div class="museum-page" data-page-id="common">
        <h2>Tesoros Comunes</h2>
        <div class="item-grid" id="museum-common-list"></div>
      </div>
      <div class="museum-page" data-page-id="uncommon">
        <h2>Tesoros Poco Comunes</h2>
        <div class="item-grid" id="museum-uncommon-list"></div>
      </div>
      <div class="museum-page" data-page-id="rare">
        <h2>Tesoros Raros</h2>
        <div class="item-grid" id="museum-rare-list"></div>
      </div>

      <!-- Controles del libro del museo -->
      <div id="museum-controls">
        <button id="museum-prev-page">â€¹ Anterior</button>
        <button id="museum-next-page">Siguiente â€º</button>
      </div>
    </div>
  </div>

  <!-- MENU ADMIN REDISEÃ‘ADO -->
  <div id="admin-menu" class="action-modal">
    <div class="modal-header">
      <h2>ğŸ› ï¸ Admin Menu</h2>
      <button class="close-modal-btn" onclick="toggleMenu('admin-menu')">Ã—</button>
    </div>
    <div class="modal-body">

      <!-- PaginaciÃ³n de Objetos para AÃ±adir -->
      <div id="admin-item-book" style="margin-bottom: 20px;">
        <div class="admin-item-page" data-page-id="common">
          <h4 style="color: #eee; border-bottom: 1px solid rgba(255,255,255,0.1);">Tesoros Comunes</h4>
          <div class="admin-item-grid" id="admin-common-list"></div>
        </div>
        <div class="admin-item-page" data-page-id="uncommon">
          <h4 style="color: #eee; border-bottom: 1px solid rgba(255,255,255,0.1);">Tesoros Poco Comunes</h4>
          <div class="admin-item-grid" id="admin-uncommon-list"></div>
        </div>
        <div class="admin-item-page" data-page-id="rare">
          <h4 style="color: #eee; border-bottom: 1px solid rgba(255,255,255,0.1);">Tesoros Raros</h4>
          <div class="admin-item-grid" id="admin-rare-list"></div>
        </div>
        <div id="admin-item-controls" style="margin-top: 10px;">
          <button id="admin-prev-page" style="width: auto; display: inline-block;">â€¹ Ant</button>
          <button id="admin-next-page" style="width: auto; display: inline-block;">Sig â€º</button>
        </div>
      </div>

      <div class="admin-actions">
        <button id="admin-reset-character">Resetear Personaje</button>
        <button id="reset-stats">Resetear Stats a 0</button>
      </div>

      <div class="admin-form">
        <div class="form-group">
          <label for="admin-work-position">Puesto de trabajo:</label>
          <select id="admin-work-position">
            <option value="0">Pasante</option>
            <option value="1">Empleado Junior</option>
            <option value="2">Empleado Senior</option>
            <option value="3">Supervisor</option>
            <option value="4">Coordinador</option>
            <option value="5">Gerente</option>
            <option value="6">Director</option>
            <option value="7">CEO</option>
          </select>
        </div>
        <div class="form-group">
          <label>Vida Interna actual: <span id="admin-vida-actual">0</span></label>
          <input type="number" id="admin-edad-interna" placeholder="Nueva vida interna" />
        </div>
        <div class="form-group"><label for="admin-dinero">Dinero:</label><input type="number" id="admin-dinero"
            placeholder="Nuevo dinero" /></div>
        <div class="form-group"><label for="admin-flappy">RÃ©cord Flappy Bird:</label><input type="number"
            id="admin-flappy" placeholder="Nuevo rÃ©cord" /></div>
        <div class="form-group"><label for="admin-peso">Peso (kg):</label><input type="number" id="admin-peso"
            placeholder="Nuevo peso" step="0.1" /></div>
      </div>
      <button id="admin-edad-aceptar">Aplicar Cambios</button>
    </div>
  </div>

  <!-- Â¡NUEVO! Overlay para eventos de pantalla completa (como el abandono del paseo) -->
  <div id="event-overlay">
    <div id="event-character">
      <!-- El personaje del evento se cargarÃ¡ aquÃ­ -->
    </div>
    <div id="event-dialog"></div>
  </div>

  <!-- MENU DE AJUSTES (Settings) -->
  <div id="settings-menu" class="action-modal">
    <div class="modal-header">
      <h2>âš™ï¸ Ajustes</h2>
      <button class="close-modal-btn" onclick="toggleMenu('settings-menu')">Ã—</button>
    </div>
    <div class="modal-body">
      <div class="setting-item">
        <label>Modo de Personaje:</label>
        <div class="toggle-container">
          <button id="btn-mode-arcade" class="mode-btn active" onclick="setGameMode('arcade')">Arcade</button>
          <button id="btn-mode-modern" class="mode-btn" onclick="setGameMode('modern')">Moderno</button>
        </div>
      </div>

      <div class="setting-item" style="margin-top: 15px;">
        <label>Calidad GrÃ¡fica:</label>
        <div class="toggle-container">
          <button id="btn-graphics-saver" class="mode-btn active" onclick="setGraphicsMode('saver')">Ahorro</button>
          <button id="btn-graphics-high" class="mode-btn" onclick="setGraphicsMode('high')">Alta Calidad</button>
        </div>
        <small style="color: #aaa; font-size: 0.75rem; display: block; margin-top: 5px;">
          "Ahorro" es el modo clÃ¡sico. "Alta Calidad" aÃ±ade detalles y animaciones fluidas.
        </small>
      </div>
    </div>
  </div>



</body>

</html>